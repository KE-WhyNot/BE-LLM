# ê¸ˆìœµ ì±—ë´‡ ì„œë¹„ìŠ¤ í†µí•© ì•„í‚¤í…ì²˜ ë¬¸ì„œ

> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-05  
> **ë²„ì „**: 3.0 (LangGraph ë™ì  í”„ë¡¬í”„íŒ… + Neo4j RAG í†µí•©)

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [í´ë¦°ì½”ë“œ 6ì›ì¹™ ì¤€ìˆ˜](#í´ë¦°ì½”ë“œ-6ì›ì¹™-ì¤€ìˆ˜)
3. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
4. [í•µì‹¬ ì•„í‚¤í…ì²˜](#í•µì‹¬-ì•„í‚¤í…ì²˜)
5. [LangGraph ë™ì  í”„ë¡¬í”„íŒ…](#langgraph-ë™ì -í”„ë¡¬í”„íŒ…)
6. [Neo4j RAG ì‹œìŠ¤í…œ](#neo4j-rag-ì‹œìŠ¤í…œ)
7. [ë‰´ìŠ¤ ì²˜ë¦¬ í”Œë¡œìš°](#ë‰´ìŠ¤-ì²˜ë¦¬-í”Œë¡œìš°)
8. [ì„œë¹„ìŠ¤ í†µí•© ë§µ](#ì„œë¹„ìŠ¤-í†µí•©-ë§µ)
9. [ì‹¤í–‰ íë¦„ ì˜ˆì‹œ](#ì‹¤í–‰-íë¦„-ì˜ˆì‹œ)
10. [ì„±ëŠ¥ ìµœì í™”](#ì„±ëŠ¥-ìµœì í™”)

---

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### í•µì‹¬ ê¸°ëŠ¥

1. **LangGraph ê¸°ë°˜ ë™ì  ì›Œí¬í”Œë¡œìš°**
   - ì¿¼ë¦¬ ë³µì¡ë„ì— ë”°ë¥¸ ì§€ëŠ¥í˜• ì„œë¹„ìŠ¤ ì„ íƒ
   - ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„±ìœ¼ë¡œ ë§¥ë½ ê¸°ë°˜ ì‘ë‹µ
   - ë³‘ë ¬ ì²˜ë¦¬ë¥¼ í†µí•œ ì„±ëŠ¥ ìµœì í™”

2. **Neo4j ì§€ì‹ê·¸ë˜í”„ RAG**
   - ë§¤ì¼ê²½ì œ RSS í”¼ë“œ ìë™ ìˆ˜ì§‘ (ìˆ˜ë™ ì—…ë°ì´íŠ¸)
   - KF-DeBERTa ì„ë² ë”© (ì¹´ì¹´ì˜¤ë±…í¬ ê¸ˆìœµ íŠ¹í™” ëª¨ë¸)
   - ì˜ë¯¸ ê¸°ë°˜ ë‰´ìŠ¤ ê²€ìƒ‰ ë° ê´€ê³„ ë¶„ì„

3. **ì‹¤ì‹œê°„ ë‰´ìŠ¤ ë²ˆì—­**
   - Google RSSì—ì„œ ì‹¤ì‹œê°„ ë‰´ìŠ¤ ìˆ˜ì§‘
   - í•œêµ­ì–´ ìë™ ë²ˆì—­ (ì‚¬ìš©ì ìš”ì²­ ì‹œ)
   - ë‹¤êµ­ì–´ ë‰´ìŠ¤ í†µí•© ì œê³µ

4. **í†µí•© ê¸ˆìœµ ë°ì´í„°**
   - yfinance API ì‹¤ì‹œê°„ ì£¼ê°€ ì¡°íšŒ
   - Pinecone ë²¡í„° ê²€ìƒ‰ (ê¸ˆìœµ ì§€ì‹ RAG)
   - Neo4j ì§€ì‹ê·¸ë˜í”„ (ë§¤ì¼ê²½ì œ ë‰´ìŠ¤)
   - ì°¨íŠ¸ ì‹œê°í™” ë° ë¶„ì„

---

## ğŸ“ í´ë¦°ì½”ë“œ 6ì›ì¹™ ì¤€ìˆ˜

### 1. **ë‹¨ì¼ ì±…ì„ ì›ì¹™ (SRP - Single Responsibility Principle)**
```
âœ… ê° ì„œë¹„ìŠ¤ëŠ” í•˜ë‚˜ì˜ ëª…í™•í•œ ì±…ì„ë§Œ ê°€ì§
- query_classifier_service.py â†’ ì¿¼ë¦¬ ë¶„ë¥˜ë§Œ
- financial_data_service.py â†’ ê¸ˆìœµ ë°ì´í„° ì¡°íšŒë§Œ
- news_service.py â†’ ë‰´ìŠ¤ ì¡°íšŒ ë° ë²ˆì—­ë§Œ
- mk_rss_scraper.py â†’ ë§¤ì¼ê²½ì œ RSS ìˆ˜ì§‘ ë° ì„ë² ë”©ë§Œ
```

### 2. **ê°œë°©-íì‡„ ì›ì¹™ (OCP - Open/Closed Principle)**
```
âœ… í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³  ìˆ˜ì •ì—ëŠ” ë‹«í˜€ìˆìŒ
- ìƒˆë¡œìš´ ë‰´ìŠ¤ ì†ŒìŠ¤ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ì´ í™•ì¥ ê°€ëŠ¥
- ìƒˆë¡œìš´ LLM ëª¨ë¸ ì¶”ê°€ ì‹œ model_selector.pyë§Œ ìˆ˜ì •
- ìƒˆë¡œìš´ ì›Œí¬í”Œë¡œìš° ë…¸ë“œ ì¶”ê°€ ì‹œ ê¸°ì¡´ ë…¸ë“œ ì˜í–¥ ì—†ìŒ
```

### 3. **ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ ì›ì¹™ (LSP - Liskov Substitution Principle)**
```
âœ… ì¸í„°í˜ì´ìŠ¤ ì¼ê´€ì„± ìœ ì§€
- ëª¨ë“  ì„œë¹„ìŠ¤ëŠ” ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ íŒ¨í„´ ì‚¬ìš©
- NewsServiceëŠ” mk_rss_scraperì™€ google_rssë¥¼ ë™ì¼í•˜ê²Œ ì²˜ë¦¬
- RAG ì„œë¹„ìŠ¤ëŠ” Pineconeê³¼ Neo4jë¥¼ íˆ¬ëª…í•˜ê²Œ ì „í™˜ ê°€ëŠ¥
```

### 4. **ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™ (ISP - Interface Segregation Principle)**
```
âœ… í•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
- workflow_componentsëŠ” í•„ìš”í•œ ì„œë¹„ìŠ¤ë§Œ import
- langgraph_enhancedëŠ” ë…ë¦½ì ì¸ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
- ê° ì„œë¹„ìŠ¤ëŠ” ìì‹ ì´ í•„ìš”í•œ ìœ í‹¸ë¦¬í‹°ë§Œ ì‚¬ìš©
```

### 5. **ì˜ì¡´ì„± ì—­ì „ ì›ì¹™ (DIP - Dependency Inversion Principle)**
```
âœ… ì¶”ìƒí™”ì— ì˜ì¡´, êµ¬ì²´í™”ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- ì„œë¹„ìŠ¤ëŠ” êµ¬ì²´ì ì¸ êµ¬í˜„ì´ ì•„ë‹Œ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
- LLM ì„ íƒì€ ì¶”ìƒ ë ˆì´ì–´ë¥¼ í†µí•´ ì²˜ë¦¬
- ë°ì´í„° ì†ŒìŠ¤ ë³€ê²½ ì‹œ ì„œë¹„ìŠ¤ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
```

### 6. **DRY ì›ì¹™ (Don't Repeat Yourself)**
```
âœ… ì½”ë“œ ì¤‘ë³µ ìµœì†Œí™”
- stock_utils.py: ì£¼ì‹ ì‹¬ë³¼ ë§¤í•‘ í†µí•©
- prompt_manager.py: í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì¤‘ì•™ ê´€ë¦¬
- formatters.py: ë°ì´í„° í¬ë§·íŒ… ê³µí†µí™”
- error_handler.py: ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ í†µí•©
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
app/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ chatbot/                              # ğŸ¤– ë©”ì¸ ì±—ë´‡ ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ chatbot_service.py               # ì§„ì…ì 
â”‚   â”‚   â””â”€â”€ financial_workflow.py            # LangGraph ì›Œí¬í”Œë¡œìš°
â”‚   â”‚
â”‚   â”œâ”€â”€ langgraph_enhanced/                   # ğŸ§  ì§€ëŠ¥í˜• ì›Œí¬í”Œë¡œìš° (NEW)
â”‚   â”‚   â”œâ”€â”€ simplified_intelligent_workflow.py # ë©”ì¸ ì›Œí¬í”Œë¡œìš°
â”‚   â”‚   â”œâ”€â”€ prompt_manager.py                # ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ llm_manager.py                   # LLM í†µí•© ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ model_selector.py                # ëª¨ë¸ ì„ íƒ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ error_handler.py                 # í†µí•© ì—ëŸ¬ ì²˜ë¦¬
â”‚   â”‚   â””â”€â”€ components/                      # ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸
â”‚   â”‚       â”œâ”€â”€ query_complexity_analyzer.py  # ì¿¼ë¦¬ ë³µì¡ë„ ë¶„ì„
â”‚   â”‚       â”œâ”€â”€ service_planner.py           # ì„œë¹„ìŠ¤ ì‹¤í–‰ ê³„íš
â”‚   â”‚       â”œâ”€â”€ service_executor.py          # ë³‘ë ¬ ì„œë¹„ìŠ¤ ì‹¤í–‰
â”‚   â”‚       â”œâ”€â”€ result_combiner.py           # ê²°ê³¼ ì¡°í•©
â”‚   â”‚       â””â”€â”€ confidence_calculator.py     # ì‹ ë¢°ë„ ê³„ì‚°
â”‚   â”‚
â”‚   â”œâ”€â”€ workflow_components/                  # âš™ï¸ ì›Œí¬í”Œë¡œìš° êµ¬ì„± ìš”ì†Œ
â”‚   â”‚   â”œâ”€â”€ query_classifier_service.py      # LLM ì¿¼ë¦¬ ë¶„ë¥˜
â”‚   â”‚   â”œâ”€â”€ financial_data_service.py        # ê¸ˆìœµ ë°ì´í„° ì¡°íšŒ
â”‚   â”‚   â”œâ”€â”€ analysis_service.py              # ë°ì´í„° ë¶„ì„
â”‚   â”‚   â”œâ”€â”€ news_service.py                  # ë‰´ìŠ¤ í†µí•© ì„œë¹„ìŠ¤ (UPDATED)
â”‚   â”‚   â”œâ”€â”€ mk_rss_scraper.py                # ë§¤ì¼ê²½ì œ RSS + Neo4j (NEW)
â”‚   â”‚   â”œâ”€â”€ data_agent_service.py            # ë°ì´í„° ì—ì´ì „íŠ¸
â”‚   â”‚   â”œâ”€â”€ visualization_service.py         # ì°¨íŠ¸ ì‹œê°í™”
â”‚   â”‚   â””â”€â”€ response_generator_service.py    # ì‘ë‹µ ìƒì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ portfolio/                            # ğŸ’¼ í¬íŠ¸í´ë¦¬ì˜¤
â”‚   â”‚   â””â”€â”€ portfolio_advisor.py             # í¬íŠ¸í´ë¦¬ì˜¤ ì œì•ˆ
â”‚   â”‚
â”‚   â””â”€â”€ (ê³µí†µ ì„œë¹„ìŠ¤)                         # ğŸ”§ ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ pinecone_rag_service.py          # Pinecone RAG
â”‚       â”œâ”€â”€ monitoring_service.py            # ëª¨ë‹ˆí„°ë§
â”‚       â””â”€â”€ user_service.py                  # ì‚¬ìš©ì ê´€ë¦¬
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ stock_utils.py                       # ì£¼ì‹ ì‹¬ë³¼ í†µí•©
    â”œâ”€â”€ common_utils.py                      # ê³µí†µ ìœ í‹¸ë¦¬í‹°
    â””â”€â”€ formatters/
        â””â”€â”€ formatters.py                    # ë°ì´í„° í¬ë§·í„°
```

---

## ğŸ—ï¸ í•µì‹¬ ì•„í‚¤í…ì²˜

### ì „ì²´ ì‹œìŠ¤í…œ íë¦„

```mermaid
graph TD
    A[ì‚¬ìš©ì ì¿¼ë¦¬] --> B[FastAPI Router]
    B --> C[ChatbotService]
    C --> D{LangGraph Enhanced?}
    
    D -->|ë³µì¡í•œ ì¿¼ë¦¬| E[SimplifiedIntelligentWorkflow]
    D -->|ë‹¨ìˆœí•œ ì¿¼ë¦¬| F[FinancialWorkflow]
    
    E --> G[QueryComplexityAnalyzer]
    G --> H[ServicePlanner]
    H --> I[ServiceExecutor ë³‘ë ¬ ì‹¤í–‰]
    I --> J[ResultCombiner]
    J --> K[PromptManager ë™ì  í”„ë¡¬í”„íŠ¸]
    K --> L[LLM ì‘ë‹µ ìƒì„±]
    
    F --> M[QueryClassifier]
    M --> N{ì¿¼ë¦¬ íƒ€ì…}
    
    N -->|data| O[FinancialDataService]
    N -->|analysis| P[AnalysisService]
    N -->|news| Q[NewsService]
    N -->|knowledge| R[Pinecone RAG Service]
    N -->|visualization| S[VisualizationService]
    
    Q --> T{ë‰´ìŠ¤ ì†ŒìŠ¤}
    T -->|ë§¤ì¼ê²½ì œ| U[MKRSSScraper + Neo4j]
    T -->|Google RSS| V[ì‹¤ì‹œê°„ ë‰´ìŠ¤ + ë²ˆì—­]
    
    L --> W[ìµœì¢… ì‘ë‹µ]
    O --> X[ResponseGenerator]
    P --> X
    Q --> X
    R --> X
    S --> X
    X --> W
```

---

## ğŸ§  LangGraph ë™ì  í”„ë¡¬í”„íŒ…

### 1. ì¿¼ë¦¬ ë³µì¡ë„ ë¶„ì„

```python
# app/services/langgraph_enhanced/components/query_complexity_analyzer.py

class QueryComplexityAnalyzer:
    """ì¿¼ë¦¬ ë³µì¡ë„ë¥¼ ë¶„ì„í•˜ì—¬ í•„ìš”í•œ ì„œë¹„ìŠ¤ ê²°ì •"""
    
    def analyze_complexity(self, query: str) -> ComplexityAnalysis:
        """
        ë³µì¡ë„ ë ˆë²¨:
        - SIMPLE: ë‹¨ì¼ ì„œë¹„ìŠ¤ (ì˜ˆ: "ì‚¼ì„±ì „ì ì£¼ê°€")
        - MODERATE: 2-3ê°œ ì„œë¹„ìŠ¤ (ì˜ˆ: "ì‚¼ì„±ì „ì ë¶„ì„í•˜ê³  ë‰´ìŠ¤ë„ ì•Œë ¤ì¤˜")
        - COMPLEX: 4ê°œ ì´ìƒ ì„œë¹„ìŠ¤ (ì˜ˆ: "ì‚¼ì„±ì „ì ì „ì²´ ë¶„ì„")
        
        í•„ìš” ì„œë¹„ìŠ¤ ìë™ ê°ì§€:
        - financial_data: ì£¼ê°€, ì‹œì„¸ í‚¤ì›Œë“œ
        - analysis: ë¶„ì„, íˆ¬ì í‚¤ì›Œë“œ
        - news: ë‰´ìŠ¤, ë™í–¥ í‚¤ì›Œë“œ
        - knowledge: ìš©ì–´, ê°œë… í‚¤ì›Œë“œ
        - visualization: ì°¨íŠ¸, ê·¸ë˜í”„ í‚¤ì›Œë“œ
    """
```

### 2. ì„œë¹„ìŠ¤ ì‹¤í–‰ ê³„íš

```python
# app/services/langgraph_enhanced/components/service_planner.py

class ServicePlanner:
    """ì„œë¹„ìŠ¤ ì‹¤í–‰ ê³„íš ìˆ˜ë¦½"""
    
    def create_service_plan(self, 
                           required_services: List[str],
                           complexity_level: str,
                           context: Dict) -> ServicePlan:
        """
        ì‹¤í–‰ ê³„íš:
        1. ë³‘ë ¬ ì‹¤í–‰ ê°€ëŠ¥ ì„œë¹„ìŠ¤ ê·¸ë£¹í•‘
           - Group 1: financial_data, news (ë™ì‹œ ì‹¤í–‰ ê°€ëŠ¥)
           - Group 2: analysis (ë°ì´í„° í•„ìš”, ìˆœì°¨ ì‹¤í–‰)
        
        2. ì‹¤í–‰ ìˆœì„œ ìµœì í™”
           - ì˜ì¡´ì„± ìˆëŠ” ì„œë¹„ìŠ¤ëŠ” ìˆœì°¨ ì‹¤í–‰
           - ë…ë¦½ì ì¸ ì„œë¹„ìŠ¤ëŠ” ë³‘ë ¬ ì‹¤í–‰
        
        3. íƒ€ì„ì•„ì›ƒ ì„¤ì •
           - SIMPLE: 5ì´ˆ
           - MODERATE: 10ì´ˆ
           - COMPLEX: 15ì´ˆ
    """
```

### 3. ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„±

```python
# app/services/langgraph_enhanced/prompt_manager.py

class PromptManager:
    """ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„±"""
    
    def generate_analysis_prompt(self, 
                                financial_data: Dict,
                                user_query: str,
                                user_context: Optional[Dict] = None) -> str:
        """
        ì‚¬ìš©ì ë§¥ë½ ê¸°ë°˜ ë™ì  í”„ë¡¬í”„íŠ¸:
        
        1. ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ (user_context ì—†ìŒ)
           - í‘œì¤€ ë¶„ì„ í…œí”Œë¦¿ ì‚¬ìš©
           - ê°ê´€ì  ë°ì´í„° ë¶„ì„
        
        2. ë§ì¶¤í˜• í”„ë¡¬í”„íŠ¸ (user_context ìˆìŒ)
           - ì‚¬ìš©ì íˆ¬ì ê²½í—˜ ìˆ˜ì¤€ ë°˜ì˜
           - ë¦¬ìŠ¤í¬ í—ˆìš©ë„ ê³ ë ¤
           - íˆ¬ì ëª©í‘œì— ë§ëŠ” ì¡°ì–¸
        
        3. ì‹¤ì‹œê°„ ë°ì´í„° ë°˜ì˜
           - ìµœì‹  ì£¼ê°€ ì •ë³´
           - ë‰´ìŠ¤ ê°ì • ë¶„ì„
           - ì‹œì¥ ìƒí™©
        """
```

### 4. ë³‘ë ¬ ì„œë¹„ìŠ¤ ì‹¤í–‰

```python
# app/services/langgraph_enhanced/components/service_executor.py

class ServiceExecutor:
    """ì„œë¹„ìŠ¤ ë³‘ë ¬ ì‹¤í–‰"""
    
    def execute_services_parallel(self, 
                                  service_plan: ServicePlan,
                                  query: str) -> Dict[str, Any]:
        """
        ë³‘ë ¬ ì‹¤í–‰ ì „ëµ:
        
        1. ThreadPoolExecutor ì‚¬ìš©
           - ìµœëŒ€ 5ê°œ ìŠ¤ë ˆë“œ
           - I/O ë°”ìš´ë“œ ì‘ì—…ì— ìµœì í™”
        
        2. ì‹¤í–‰ ê·¸ë£¹ë³„ ì²˜ë¦¬
           - Group 1: ë°ì´í„° ì¡°íšŒ (ë³‘ë ¬)
           - Group 2: ë¶„ì„ (ìˆœì°¨, ë°ì´í„° ì˜ì¡´)
           - Group 3: ì‘ë‹µ ìƒì„± (ìˆœì°¨, ëª¨ë“  ê²°ê³¼ ì˜ì¡´)
        
        3. ì—ëŸ¬ ì²˜ë¦¬
           - ê°œë³„ ì„œë¹„ìŠ¤ ì‹¤íŒ¨ ì‹œ ê³„ì† ì§„í–‰
           - í•„ìˆ˜ ì„œë¹„ìŠ¤ ì‹¤íŒ¨ ì‹œ í´ë°±
        """
```

---

## ğŸ—„ï¸ Neo4j RAG ì‹œìŠ¤í…œ

### 1. ë§¤ì¼ê²½ì œ RSS ìˆ˜ì§‘ (ìˆ˜ë™ ì—…ë°ì´íŠ¸)

```python
# app/services/workflow_components/mk_rss_scraper.py

class MKNewsScraper:
    """ë§¤ì¼ê²½ì œ RSS í”¼ë“œ ìŠ¤í¬ë˜í¼"""
    
    # RSS í”¼ë“œ URL
    rss_feeds = {
        'economy': 'https://www.mk.co.kr/rss/30100041/',      # ê²½ì œ
        'politics': 'https://www.mk.co.kr/rss/30200030/',     # ì •ì¹˜
        'securities': 'https://www.mk.co.kr/rss/50200011/',   # ì¦ê¶Œ
        'international': 'https://www.mk.co.kr/rss/50100032/', # êµ­ì œ
        'headlines': 'https://www.mk.co.kr/rss/30000001/'     # í—¤ë“œë¼ì¸
    }
    
    # KF-DeBERTa ì„ë² ë”© ëª¨ë¸ (ì¹´ì¹´ì˜¤ë±…í¬ ê¸ˆìœµ íŠ¹í™”)
    embedding_model = SentenceTransformer('kakaobank/kf-deberta-base')
```

### 2. ì§€ì‹ê·¸ë˜í”„ êµ¬ì¡°

```
Neo4j ë…¸ë“œ êµ¬ì¡°:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Article (ê¸°ì‚¬ ë…¸ë“œ)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - article_id: String (ê³ ìœ  ID)      â”‚
â”‚ - title: String (ì œëª©)              â”‚
â”‚ - link: String (URL)                â”‚
â”‚ - published: DateTime (ë°œí–‰ì¼)      â”‚
â”‚ - category: String (ì¹´í…Œê³ ë¦¬)       â”‚
â”‚ - content: String (ë³¸ë¬¸)            â”‚
â”‚ - summary: String (ìš”ì•½)            â”‚
â”‚ - embedding: List<Float> (768ì°¨ì›)  â”‚
â”‚ - created_at: DateTime              â”‚
â”‚ - updated_at: DateTime              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ê´€ê³„ êµ¬ì¡°:
Article --[SIMILAR_TO {similarity: Float}]--> Article
Article --[BELONGS_TO {category: String}]--> Category
Article --[MENTIONS {entity: String}]--> Entity
```

### 3. ì„ë² ë”© ê¸°ë°˜ ê²€ìƒ‰

```python
# ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê²€ìƒ‰
MATCH (a:Article)
WHERE a.embedding IS NOT NULL
WITH a, gds.similarity.cosine(a.embedding, $query_embedding) AS similarity
WHERE similarity > 0.7
RETURN a.title, a.summary, a.link, similarity
ORDER BY similarity DESC
LIMIT 10
```

### 4. ìˆ˜ë™ ì—…ë°ì´íŠ¸ ë°©ë²•

```python
# ë§¤ì¼ê²½ì œ ì§€ì‹ê·¸ë˜í”„ ì—…ë°ì´íŠ¸ (ìˆ˜ë™ ì‹¤í–‰)
from app.services.workflow_components.mk_rss_scraper import update_mk_knowledge_graph

# ìµœê·¼ 7ì¼ ë‰´ìŠ¤ ìˆ˜ì§‘ + ì„ë² ë”© + Neo4j ì €ì¥
result = await update_mk_knowledge_graph(days_back=7)

# ê²°ê³¼:
# {
#   "execution_time": 45.2,
#   "articles_collected": 250,
#   "storage_stats": {
#     "new_articles": 230,
#     "updated_articles": 20
#   },
#   "status": "success"
# }
```

---

## ğŸ“° ë‰´ìŠ¤ ì²˜ë¦¬ í”Œë¡œìš°

### 1. ë‰´ìŠ¤ ì†ŒìŠ¤ ë¶„ê¸°

```python
# app/services/workflow_components/news_service.py

class NewsService:
    """í†µí•© ë‰´ìŠ¤ ì„œë¹„ìŠ¤"""
    
    async def get_comprehensive_news(self, query: str) -> List[Dict]:
        """
        ë‰´ìŠ¤ ì†ŒìŠ¤ ì„ íƒ:
        
        1. ë§¤ì¼ê²½ì œ Neo4j RAG (ê¸°ë³¸)
           - ìˆ˜ë™ ì—…ë°ì´íŠ¸ëœ í•œêµ­ ë‰´ìŠ¤
           - ì„ë² ë”© ê¸°ë°˜ ì˜ë¯¸ ê²€ìƒ‰
           - ê´€ê³„ ë¶„ì„ í¬í•¨
        
        2. Google RSS (ì‹¤ì‹œê°„)
           - ì‚¬ìš©ì ìš”ì²­ ì‹œ ì‹¤ì‹œê°„ ë‰´ìŠ¤
           - ì˜ì–´ ë‰´ìŠ¤ ìë™ ë²ˆì—­
           - ë‹¤êµ­ì–´ ë‰´ìŠ¤ í†µí•©
        
        3. í†µí•© ì‘ë‹µ
           - ì¤‘ë³µ ì œê±° (URL ê¸°ì¤€)
           - ê´€ë ¨ë„ ìˆœ ì •ë ¬
           - ìµœëŒ€ 10ê°œ ë°˜í™˜
"""
```

### 2. ì‹¤ì‹œê°„ ë‰´ìŠ¤ ë²ˆì—­

```python
# Google RSS â†’ í•œêµ­ì–´ ë²ˆì—­ í”Œë¡œìš°

async def get_google_rss_news(self, query: str) -> List[Dict]:
    """
    1. Google RSS ê²€ìƒ‰
       - feedparserë¡œ RSS íŒŒì‹±
       - ì¿¼ë¦¬ ê´€ë ¨ ë‰´ìŠ¤ í•„í„°ë§
    
    2. ìë™ ë²ˆì—­
       - Google Translate API ì‚¬ìš©
       - ì œëª© + ìš”ì•½ í•œêµ­ì–´ ë²ˆì—­
       - ì›ë¬¸ ë§í¬ ìœ ì§€
    
    3. ë©”íƒ€ë°ì´í„° ì¶”ê°€
       - ë°œí–‰ì¼, ì¶œì²˜
       - ë²ˆì—­ ì—¬ë¶€ í‘œì‹œ
       - ì‹ ë¢°ë„ ì ìˆ˜
"""
```

### 3. ë‰´ìŠ¤ í†µí•© ë° ì¤‘ë³µ ì œê±°

```python
async def get_comprehensive_news(self, query: str, use_embedding: bool = True):
    """
    í†µí•© ì „ëµ:
    
    1. ë§¤ì¼ê²½ì œ Neo4j (use_embedding=True)
       - ì„ë² ë”© ê¸°ë°˜ ê²€ìƒ‰ (3ê°œ)
       - ë†’ì€ ì •í™•ë„
    
    2. Google RSS (ì‹¤ì‹œê°„)
       - í‚¤ì›Œë“œ ê¸°ë°˜ ê²€ìƒ‰ (5ê°œ)
       - ìµœì‹  ë‰´ìŠ¤
    
    3. ì¤‘ë³µ ì œê±°
       - URL ê¸°ì¤€ ì¤‘ë³µ ì²´í¬
       - ì œëª© ìœ ì‚¬ë„ ì²´í¬ (>0.9)
    
    4. ì •ë ¬ ë° ë°˜í™˜
       - ê´€ë ¨ë„ + ìµœì‹ ìˆœ
       - ìµœëŒ€ 10ê°œ
"""
```

---

## ğŸ”— ì„œë¹„ìŠ¤ í†µí•© ë§µ

### ë ˆì´ì–´ë³„ ì±…ì„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: API Layer (FastAPI Router)                    â”‚
â”‚ - ìš”ì²­ ê²€ì¦                                              â”‚
â”‚ - ì¸ì¦/ì¸ê°€                                              â”‚
â”‚ - ì‘ë‹µ í¬ë§·íŒ…                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: Service Layer (ChatbotService)                â”‚
â”‚ - ì›Œí¬í”Œë¡œìš° ì„ íƒ                                        â”‚
â”‚ - ëª¨ë‹ˆí„°ë§                                               â”‚
â”‚ - ì„¸ì…˜ ê´€ë¦¬                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: Workflow Layer                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ LangGraph       â”‚ Simplified Intelligent          â”‚  â”‚
â”‚ â”‚ Enhanced        â”‚ Workflow                        â”‚  â”‚
â”‚ â”‚ (ë³µì¡í•œ ì¿¼ë¦¬)    â”‚ (ë™ì  í”„ë¡¬í”„íŒ…)                  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Financial Workflow (ë‹¨ìˆœí•œ ì¿¼ë¦¬)                     â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: Component Layer (Workflow Components)         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Query    â”‚ Financialâ”‚ Analysis â”‚ News     â”‚ Visual â”‚ â”‚
â”‚ â”‚ Classify â”‚ Data     â”‚ Service  â”‚ Service  â”‚ -ize   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: Data Layer                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ChromaDB   â”‚ Neo4j      â”‚ yfinance   â”‚ Google RSS  â”‚ â”‚
â”‚ â”‚ (ê¸ˆìœµì§€ì‹)  â”‚ (ë‰´ìŠ¤ê·¸ë˜í”„)â”‚ (ì£¼ê°€)     â”‚ (ì‹¤ì‹œê°„ë‰´ìŠ¤) â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ ì‹¤í–‰ íë¦„ ì˜ˆì‹œ

### ì˜ˆì‹œ 1: "ì‚¼ì„±ì „ì ì£¼ê°€ì™€ ìµœê·¼ ë‰´ìŠ¤ ì•Œë ¤ì¤˜" (ë³µì¡í•œ ì¿¼ë¦¬)

```
1. FastAPI Router
   â””â”€â–º POST /chat

2. ChatbotService
   â””â”€â–º ì¿¼ë¦¬ ë³µì¡ë„ íŒë‹¨ â†’ MODERATE (2ê°œ ì„œë¹„ìŠ¤ í•„ìš”)
   â””â”€â–º SimplifiedIntelligentWorkflow ì„ íƒ

3. QueryComplexityAnalyzer
   â””â”€â–º í•„ìš” ì„œë¹„ìŠ¤: ["financial_data", "news"]
   â””â”€â–º ë³µì¡ë„: MODERATE

4. ServicePlanner
   â””â”€â–º ì‹¤í–‰ ê³„íš:
       - Group 1 (ë³‘ë ¬): financial_data, news
       - Group 2 (ìˆœì°¨): response_generation

5. ServiceExecutor (ë³‘ë ¬ ì‹¤í–‰)
   â”œâ”€â–º Thread 1: FinancialDataService
   â”‚   â””â”€â–º yfinance API â†’ ì‚¼ì„±ì „ì ì£¼ê°€ ë°ì´í„°
   â”‚
   â””â”€â–º Thread 2: NewsService
       â”œâ”€â–º MKRSSScraper (Neo4j)
       â”‚   â””â”€â–º ì„ë² ë”© ê²€ìƒ‰ â†’ ë§¤ì¼ê²½ì œ ë‰´ìŠ¤ 3ê°œ
       â”‚
       â””â”€â–º Google RSS (ì‹¤ì‹œê°„)
           â””â”€â–º í‚¤ì›Œë“œ ê²€ìƒ‰ + ë²ˆì—­ â†’ ê¸€ë¡œë²Œ ë‰´ìŠ¤ 2ê°œ

6. ResultCombiner
   â””â”€â–º ì£¼ê°€ ë°ì´í„° + ë‰´ìŠ¤ 5ê°œ í†µí•©

7. PromptManager
   â””â”€â–º ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„±:
       "ë‹¤ìŒ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‚¼ì„±ì „ìì˜ í˜„ì¬ ìƒí™©ì„ ë¶„ì„í•˜ì„¸ìš”:
        ì£¼ê°€: 86,000ì› (+3.24%)
        ë‰´ìŠ¤: [5ê°œ ë‰´ìŠ¤ ìš”ì•½]
        ì‚¬ìš©ì ì§ˆë¬¸: ì‚¼ì„±ì „ì ì£¼ê°€ì™€ ìµœê·¼ ë‰´ìŠ¤ ì•Œë ¤ì¤˜"

8. LLM (Gemini 2.0 Flash)
   â””â”€â–º ë§¥ë½ ê¸°ë°˜ ì‘ë‹µ ìƒì„±

9. ìµœì¢… ì‘ë‹µ
   â””â”€â–º "ğŸ“Š ì‚¼ì„±ì „ì í˜„ì¬ ìƒí™©
        
        ğŸ’° ì£¼ê°€ ì •ë³´:
        - í˜„ì¬ê°€: 86,000ì›
        - ì „ì¼ëŒ€ë¹„: +2,700ì› (+3.24%)
        - ê±°ë˜ëŸ‰: 23,156,553ì£¼
        
        ğŸ“° ìµœê·¼ ë‰´ìŠ¤:
        1. [ë§¤ì¼ê²½ì œ] ì‚¼ì„±ì „ì, 3ë¶„ê¸° ì‹¤ì  í˜¸ì¡° ì „ë§
           (ìœ ì‚¬ë„: 0.89, ê¸ì •ì )
        2. [Google] Samsung announces new chip...
           (ë²ˆì—­: ì‚¼ì„±, ì‹ ê·œ ì¹© ë°œí‘œ...)
        ...
        
        ğŸ’¡ ì¢…í•© ë¶„ì„:
        ê¸ì •ì ì¸ ë‰´ìŠ¤ì™€ í•¨ê»˜ ì£¼ê°€ê°€ ìƒìŠ¹ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤..."

ì²˜ë¦¬ ì‹œê°„: ~3.2ì´ˆ (ë³‘ë ¬ ì²˜ë¦¬ë¡œ ë‹¨ì¶•)
```

### ì˜ˆì‹œ 2: "PERì´ ë­ì•¼?" (ë‹¨ìˆœí•œ ì¿¼ë¦¬)

```
1. FastAPI Router
   â””â”€â–º POST /chat

2. ChatbotService
   â””â”€â–º ì¿¼ë¦¬ ë³µì¡ë„ íŒë‹¨ â†’ SIMPLE (1ê°œ ì„œë¹„ìŠ¤)
   â””â”€â–º FinancialWorkflow ì„ íƒ

3. QueryClassifier
   â””â”€â–º LLM ë¶„ë¥˜ â†’ "knowledge"

4. Pinecone RAG Service
   â””â”€â–º ë²¡í„° ê²€ìƒ‰ â†’ data/fundamental_analysis.txt
   â””â”€â–º ì»¨í…ìŠ¤íŠ¸: "PERì€ ì£¼ê°€ìˆ˜ìµë¹„ìœ¨ë¡œ..."

5. ResponseGenerator
   â””â”€â–º ì§€ì‹ ì‘ë‹µ ìƒì„±

6. ìµœì¢… ì‘ë‹µ
   â””â”€â–º "ğŸ“š PER(ì£¼ê°€ìˆ˜ìµë¹„ìœ¨)ì´ë€?
        
        PERì€ ì£¼ê°€ë¥¼ ì£¼ë‹¹ìˆœì´ìµìœ¼ë¡œ ë‚˜ëˆˆ ê°’ìœ¼ë¡œ,
        ê¸°ì—…ì˜ ê°€ì¹˜ë¥¼ í‰ê°€í•˜ëŠ” ì§€í‘œì…ë‹ˆë‹¤.
        
        ğŸ’¡ í•´ì„:
        - PER < 15: ì €í‰ê°€
        - PER 15-25: ì ì •ê°€
        - PER > 25: ê³ í‰ê°€
        ..."

ì²˜ë¦¬ ì‹œê°„: ~1.5ì´ˆ
```

---

## âš¡ ì„±ëŠ¥ ìµœì í™”

### 1. LLM í˜¸ì¶œ ìµœì í™”

```python
# í”„ë¡¬í”„íŠ¸ ê¸¸ì´ ì¤„ì´ê¸°
- ë¶ˆí•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ì œê±°
- í•µì‹¬ ì •ë³´ë§Œ í¬í•¨
- í† í° ìˆ˜ ëª¨ë‹ˆí„°ë§

# ìºì‹± ì „ëµ
- ë™ì¼ ì¿¼ë¦¬ ê²°ê³¼ ìºì‹± (5ë¶„)
- ì£¼ê°€ ë°ì´í„° ìºì‹± (1ë¶„)
- ë‰´ìŠ¤ ë°ì´í„° ìºì‹± (10ë¶„)
```

### 2. ì„œë¹„ìŠ¤ ë³‘ë ¬ ì²˜ë¦¬

```python
# ThreadPoolExecutor ì‚¬ìš©
with ThreadPoolExecutor(max_workers=5) as executor:
    futures = {
        executor.submit(financial_data_service.get_data, query): "data",
        executor.submit(news_service.get_news, query): "news"
    }
    
    for future in as_completed(futures):
        service_name = futures[future]
        results[service_name] = future.result()

# ì„±ëŠ¥ ê°œì„ :
- ìˆœì°¨ ì‹¤í–‰: 5ì´ˆ (2.5ì´ˆ + 2.5ì´ˆ)
- ë³‘ë ¬ ì‹¤í–‰: 2.5ì´ˆ (max(2.5ì´ˆ, 2.5ì´ˆ))
```

### 3. Neo4j ì¸ë±ìŠ¤ ìµœì í™”

```cypher
-- ê¸°ì‚¬ ID ì¸ë±ìŠ¤
CREATE INDEX article_id_index FOR (a:Article) ON (a.article_id);

-- ì¹´í…Œê³ ë¦¬ ì¸ë±ìŠ¤
CREATE INDEX article_category_index FOR (a:Article) ON (a.category);

-- ë°œí–‰ì¼ ì¸ë±ìŠ¤
CREATE INDEX article_published_index FOR (a:Article) ON (a.published);

-- ì„ë² ë”© ë²¡í„° ê²€ìƒ‰ ìµœì í™”
CALL gds.alpha.similarity.cosine.stream({
  nodeProjection: 'Article',
  relationshipProjection: '*',
  embeddingProperty: 'embedding'
})
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ë§

```python
# Pinecone í´ë¼ì´ì–¸íŠ¸ ì¬ì‚¬ìš©
from pinecone import Pinecone

pc = Pinecone(api_key=PINECONE_API_KEY)
index = pc.Index(PINECONE_INDEX_NAME)

# Neo4j ì—°ê²° í’€
graph = Graph(
    "bolt://localhost:7687",
    auth=("neo4j", "password"),
    max_connection_lifetime=3600,
    max_connection_pool_size=50
)
```

---

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ

| í•­ëª© | ê°’ |
|------|-----|
| **í‰ê·  ì‘ë‹µ ì‹œê°„ (ë‹¨ìˆœ)** | 1.5-2ì´ˆ |
| **í‰ê·  ì‘ë‹µ ì‹œê°„ (ë³µì¡)** | 3-4ì´ˆ |
| **ë³‘ë ¬ ì²˜ë¦¬ ê°œì„ ìœ¨** | ~50% |
| **LLM ë¶„ë¥˜ ì •í™•ë„** | ~95% |
| **Neo4j ê²€ìƒ‰ ì •í™•ë„** | ~90% |
| **ë§¤ì¼ê²½ì œ ë‰´ìŠ¤ ìˆ˜ì§‘** | 250ê°œ/ì¼ |
| **ì§€ì› ì¢…ëª©** | 58ê°œ |
| **ì„ë² ë”© ì°¨ì›** | 768 (KF-DeBERTa) |

---

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### í•µì‹¬ ê¸°ìˆ 
- **Framework**: FastAPI
- **LLM**: Google Gemini 2.0 Flash
- **Workflow**: LangGraph (StateGraph)
- **Vector DB**: Pinecone (ê¸ˆìœµ ì§€ì‹ RAG)
- **Graph DB**: Neo4j (ë‰´ìŠ¤ ì§€ì‹ê·¸ë˜í”„)
- **Embeddings**: 
  - KF-DeBERTa (ì¹´ì¹´ì˜¤ë±…í¬ ê¸ˆìœµ íŠ¹í™”)
  - HuggingFace Sentence Transformers
- **Financial Data**: yfinance
- **News Sources**: 
  - ë§¤ì¼ê²½ì œ RSS (Neo4j ì €ì¥)
  - Google RSS (ì‹¤ì‹œê°„)
- **Translation**: Google Translate API
- **Monitoring**: LangSmith

### ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬
```
langchain==0.3.27
langgraph==0.6.7
langchain-google-genai==2.1.12
pinecone-client>=2.2.0
py2neo>=2021.2.4
sentence-transformers>=2.2.0
yfinance==0.2.66
feedparser>=6.0.10
```

---

## ğŸ“ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

```bash
# API Keys
GOOGLE_API_KEY=your_google_api_key
OPENAI_API_KEY=your_openai_api_key  # í´ë°±ìš©
LANGSMITH_API_KEY=your_langsmith_api_key

# Neo4j ì„¤ì • (ë§¤ì¼ê²½ì œ ë‰´ìŠ¤ ì§€ì‹ê·¸ë˜í”„)
NEO4J_URI=bolt://localhost:7688
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_password

# Pinecone ì„¤ì • (RAG ë²¡í„° DB)
PINECONE_API_KEY=your_pinecone_api_key
PINECONE_INDEX_NAME=finance-rag-index

# ì„ë² ë”© ëª¨ë¸
EMBEDDING_MODEL=kakaobank/kf-deberta-base
```

### Neo4j ì„¤ì¹˜ ë° ì‹¤í–‰

```bash
# Dockerë¡œ Neo4j ì‹¤í–‰ (GDS í”ŒëŸ¬ê·¸ì¸ í¬í•¨)
docker run -p 7474:7474 -p 7688:7688 \
  -e NEO4J_AUTH=neo4j/financial123 \
  -e NEO4J_PLUGINS='["graph-data-science"]' \
  -v $PWD/neo4j/data:/data \
  --name neo4j-finance \
  neo4j:5.15.0

# ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
http://localhost:7474
```

### ë§¤ì¼ê²½ì œ ì§€ì‹ê·¸ë˜í”„ ì´ˆê¸°í™”

```bash
# Python ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
cd /Users/doyun/Desktop/KEF/BE-LLM
source venv/bin/activate
python -c "
from app.services.workflow_components.mk_rss_scraper import update_mk_knowledge_graph
import asyncio
result = asyncio.run(update_mk_knowledge_graph(days_back=7))
print(result)
"
```

---

**ë¬¸ì„œ ë²„ì „**: 3.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-05  
**ì‘ì„±ì**: Financial Chatbot Team